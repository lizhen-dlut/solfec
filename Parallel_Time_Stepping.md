# Parallel time-stepping #

![http://wiki.solfec.googlecode.com/hg/topics/pts/pts1.png](http://wiki.solfec.googlecode.com/hg/topics/pts/pts1.png)

[Link to the source code](http://code.google.com/p/solfec/source/browse/sol.c#513)

The major steps of the parallel time-stepping are summarised in Algorithm 1. The time integration is performed only for the parent bodies. In the first line, the mid-configuration of the parent bodies is computed. Then, in the second
line, it is sent to child bodies. This way updated shapes of parent and child bodies can be used when updating constraints in line 3. The domain partitioning is updated next. As a result, the sub-domain boundaries are adjusted to the new positions of bodies. This allows to redistribute child bodies in lines 5 and 6. At the same time, after the RCB update, new processors are assigned to parent bodies and internal two-body constraints. This information is used when migrating bodies and constraints in lines 7 and 8. In the next step (line 9) the set of external constraints is created. At this stage parent and child bodies store subsets of adjacent internal and external constraints. When detecting new constraints (e.g. contact points) in line 10, this information is used to discriminate newly detected, but redundant constraints (i.e. already existing). The set of new constraints is then migrated out in the form of external constraints (line 11). In line 12, a last post-processing step is executed on the complete constraint sets. This allows to eliminate duplicated contact points, previously skipped owing to the lack of information from external processors. In line 13 the
local dynamics operatorW and vector B are assembled. Each processor assembles a subset of rows of local dynamics corresponding to its own set of internal constraints. Since constraints are balanced, the amount of work needed to compute W and B is also balanced among the processors. The implicit constraint equations C(R) = 0 are solved next (line 14). This aspect of the time-stepping is discussed in Section 7. Once the reactions have been computed, the velocities
and configurations of parent bodies are updated in lines 15 and 16.